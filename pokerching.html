<html>
<head>
  <title>Pocker Ching</title>
</head>
<body>

<form>
  <div id="carta1"><input type="checkbox">1 <input type="text" name="c1"></div>
  <div id="carta2"><input type="checkbox">2 <input type="text" name="c2"></div>
  <div id="carta3"><input type="checkbox">3 <input type="text" name="c3"></div>
  <input type="button" value="Descartar(3)" onclick="descartar()">

</form>

<script language="javascript">
  // carta -> color fila1 fila2: "B01"
 // baraja -> 12 cartas (4 Y, 4 B, 4G)
 var baraja=["Y00","Y01","Y10","Y11",
             "G00","G01","G10","G11",
             "B00","B01","B10","B11"];
 var carta_actual=0;
 var descartes=3;

 //console.log(baraja);
 // console.log(baraja[1]); // Y01

 var hexagramas={};
 hexagramas["000000"]=1; hexagramas["000001"]=44;  hexagramas["000010"]=13;  hexagramas["000011"]=33;
 hexagramas["000100"]=10; hexagramas["000101"]=6;  hexagramas["000110"]=25;  hexagramas["000111"]=12;
 hexagramas["001000"]=9; hexagramas["001001"]=57;  hexagramas["001010"]=37;  hexagramas["001011"]=53;
 hexagramas["001100"]=61; hexagramas["001101"]=59;  hexagramas["001110"]=42;  hexagramas["001111"]=20;

 hexagramas["010000"]=14; hexagramas["010001"]=50;  hexagramas["010010"]=30;  hexagramas["010011"]=56;
 hexagramas["010100"]=38; hexagramas["010101"]=64;  hexagramas["010110"]=21;  hexagramas["010111"]=35;
 hexagramas["011000"]=26; hexagramas["011001"]=18;  hexagramas["011010"]=22;  hexagramas["011011"]=52;
 hexagramas["011100"]=41; hexagramas["011101"]=4;  hexagramas["011110"]=27;  hexagramas["011111"]=23;

 hexagramas["100000"]=43; hexagramas["100001"]=28;  hexagramas["100010"]=49;  hexagramas["100011"]=31;
 hexagramas["100100"]=58; hexagramas["100101"]=47;  hexagramas["100110"]=17;  hexagramas["100111"]=45;
 hexagramas["101000"]=5; hexagramas["101001"]=48;  hexagramas["101010"]=63;  hexagramas["101011"]=39;
 hexagramas["101100"]=60; hexagramas["101101"]=29;  hexagramas["101110"]=3;  hexagramas["101111"]=8;

 hexagramas["110000"]=34; hexagramas["110001"]=32;  hexagramas["110010"]=55;  hexagramas["110011"]=62;
 hexagramas["110100"]=54; hexagramas["110101"]=40;  hexagramas["110110"]=51;  hexagramas["110111"]=16;
 hexagramas["111000"]=11; hexagramas["111001"]=46;  hexagramas["111010"]=36;  hexagramas["111011"]=15;
 hexagramas["111100"]=19; hexagramas["111101"]=7;  hexagramas["111110"]=24;  hexagramas["111111"]=2;

 // console.log(hexagramas["111111"]);
 console.log(hexagramas);

function descartar(){
   if(descartes>0){
     for(i=0; i<3; i++){
       if(document.forms[0].elements[2*i].checked){
         // console.log("Descartar " + i);
         document.forms[0].elements[2*i + 1].value=baraja[carta_actual];
         carta_actual++;
       }
     }
     descartes --;
     document.forms[0].elements[6].value="Descartar("+descartes+")";
   }
   if(descartes == 0){
     fila_y=""; fila_g=""; fila_b="";

     // analizar resultado
     for(i=0;i<3;i++){
       var carta_i=document.forms[0].elements[2*i + 1].value;
       console.log(carta_i);
       var color=carta_i[0];
       if(color=="Y"){
         fila_y=carta_i.substring(1,3);
       }else if(color=="G"){
         fila_g=carta_i.substring(1,3);
       }else if(color=="B"){
         fila_b=carta_i.substring(1,3);
       }
     }

     console.log("Y: " + fila_y);
     console.log("G: " + fila_g);
     console.log("B: " + fila_b);

     if(fila_y == "" || fila_g == "" || fila_b == ""){
       console.log("Game over");
     }else{
       var clave_hexagrama= fila_y + fila_g + fila_b;
       console.log(clave_hexagrama);
       // console.log(hexagramas[clave_hexagrama];
     }
   }
}

 // permutacion del 1 al 12
// http://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex ;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}


 shuffle(baraja);
 console.log(baraja);

 document.forms[0].elements[1].value=baraja[carta_actual];
 carta_actual++;

 document.forms[0].elements[3].value=baraja[carta_actual];
 carta_actual++;

 document.forms[0].elements[5].value=baraja[carta_actual];
 carta_actual++;

</script>

</body>
</html>
